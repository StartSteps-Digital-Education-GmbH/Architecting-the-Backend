### Part 1: Travel Booking System API Documentation

#### API Naming Convention:
- All APIs should start with `/api/{microservice_name}/`.
- Use appropriate HTTP methods (GET, POST, PUT, DELETE, PATCH) for operations.
- Responses should be JSON formatted, with a consistent structure as follows:
  
  ```json
  {
    "status": "success",
    "data": { /* data or specific response */ },
    "message": "optional message about the result"
  }
  ```

#### API Requirements

#### 1. **User Service** `/api/users/`

- **POST /api/users/** 
  - **Description**: Create a new user.
  - **Request Body**:
    - `name`: String, required
    - `email`: String, required, unique
    - `age`: Number, optional
  - **Response**:
    - Return the created user object with an autogenerated `id`.

- **GET /api/users/** 
  - **Description**: Retrieve all users with pagination.
  - **Query Params**:
    - `page`: Number, optional, for pagination (default: 1)
    - `limit`: Number, optional, for pagination (default: 10)
    - `age`: (optional) filter users by a specific age
  - **Response**:
    - List of users matching any applied filter(s) and pagination details.

- **GET /api/users/:id**
  - **Description**: Get a specific user by `id`.
  - **Response**:
    - Returns the user object.

- **PUT /api/users/:id**
  - **Description**: Update user details by `id`.
  - **Request Body**:
    - Accepts any updatable field(s) from the user schema.
  - **Response**:
    - The updated user object.

- **DELETE /api/users/:id**
  - **Description**: Delete a user by `id`.
  - **Response**:
    - Confirmation message indicating successful deletion.

#### 2. **Flight Service** `/api/flights/`

- **POST /api/flights/**
  - **Description**: Create a new flight.
  - **Request Body**:
    - `origin`: String, required
    - `destination`: String, required
    - `price`: Number, required
  - **Response**:
    - Return the created flight object with an autogenerated `id`.

- **GET /api/flights/**
  - **Description**: Retrieve all flights with pagination.
  - **Query Params**:
    - `page`: Number, optional, for pagination (default: 1)
    - `limit`: Number, optional, for pagination (default: 10)
    - `origin`: (optional) filter by flight origin
    - `destination`: (optional) filter by flight destination
    - `minPrice`: (optional) filter flights above this price
    - `maxPrice`: (optional) filter flights below this price
    - `sort`: (optional) sort flights by `price` in ascending or descending order (`asc` or `desc`)
  - **Response**:
    - List of flights matching the applied filters and pagination details.

- **GET /api/flights/:id**
  - **Description**: Get specific flight details by `id`.
  - **Response**:
    - Returns the flight object.

- **PUT /api/flights/:id**
  - **Description**: Update flight details by `id`.
  - **Request Body**:
    - Accepts any updatable field(s) from the flight schema.
  - **Response**:
    - The updated flight object.

- **DELETE /api/flights/:id**
  - **Description**: Delete a flight by `id`.
  - **Response**:
    - Confirmation message indicating successful deletion.

#### 3. **Booking Service** `/api/bookings/`

- **POST /api/bookings/**
  - **Description**: Create a new booking.
  - **Request Body**:
    - `user`: ObjectId, reference to the User model
    - `flight`: ObjectId, reference to the Flight model
    - `bookingDate`: Date, required
    - `status`: String, optional, defaults to 'Pending'
  - **Response**:
    - Return the created booking object with an autogenerated `id`.

- **GET /api/bookings/**
  - **Description**: Retrieve all bookings with pagination.
  - **Query Params**:
    - `page`: Number, optional, for pagination (default: 1)
    - `limit`: Number, optional, for pagination (default: 10)
    - `user`: (optional) filter bookings by user ID
    - `flight`: (optional) filter bookings by flight ID
    - `status`: (optional) filter bookings by status (e.g., Pending, confirmed, canceled)
    - `dateRangeStart` & `dateRangeEnd`: (optional) retrieve bookings within a specific date range
  - **Response**:
    - List of bookings matching the applied filters and pagination details.

- **GET /api/bookings/:id**
  - **Description**: Get specific booking details by `id`.
  - **Response**:
    - Returns the booking object.

- **PUT /api/bookings/:id**
  - **Description**: Update booking details by `id`.
  - **Request Body**:
    - Accepts any updatable field(s) from the booking schema.
  - **Response**:
    - The updated booking object.

- **PATCH /api/bookings/:id/status**
  - **Description**: Update the status of a booking by `id`.
  - **Request Body**:
    - `status`: String, required, one of ['Pending', 'Confirmed', 'Cancelled']
  - **Response**:
    - The updated booking object with the new status.

- **DELETE /api/bookings/:id**
  - **Description**: Delete a booking by `id`.
  - **Response**:
    - Confirmation message indicating successful deletion.

#### 4. **Additional Functionalities**:

- **Flight Search**
  - **GET /api/flights/search**
  - **Description**: Search for flights by `origin` and `destination`.
  - **Query Params**:
    - `origin`: String, required
    - `destination`: String, required
  - **Response**:
    - List of flights matching the `origin` and `destination`.

- **Booking Statistics**
  - **GET /api/bookings/stats**
  - **Description**: Retrieve booking statistics.
  - **Query Params**:
    - `status`: (optional) filter stats by booking status.
  - **Response**:
    - Returns an aggregated statistics report. Example:

    ```json
    {
      "status": "success",
      "data": {
        "totalBookings": 120,
        "confirmed": 70,
        "pending": 30,
        "cancelled": 20,
        "bookingsByFlight": [
          { "flightId": "605c3b7f5a3e6349bce6f2a9", "totalBookings": 25 },
          { "flightId": "605c3b7f5a3e6349bce6f2b0", "totalBookings": 15 }
        ],
        "bookingsByUser": [
          { "userId": "605c3b7f5a3e6349bce6f2a1", "totalBookings": 10 },
          { "userId": "605c3b7f5a3e6349bce6f2b2", "totalBookings": 8 }
        ]
      }
    }
    ```
